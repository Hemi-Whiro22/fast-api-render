name: "Verify Tiwhanawhana Refactor"
description: |
  Check that Tiwhanawhana still works after reorganization.
  Validate imports, environment paths, and service startup.

checks:
  - Ensure all imports inside `core/` resolve with `python -m core.main`.
  - Confirm `.env` and `.mauri` variables load properly.
  - Verify Supabase, OpenAI, and OCR client modules import without error.
  - Test `uvicorn core.main:app --reload` for successful FastAPI boot.
  - Scan for missing relative paths or circular imports.
  - Ensure `.venv` or `venv/` is active and VS Code uses it as interpreter.
  - Confirm `archive/` and `logs/` are excluded from Git commits.

output:
  - summary_report.md: "A markdown summary of results, including any broken imports or missing paths."
  - fixed_imports_log.txt: "Autogenerated log of all import corrections."

notes:
  - Do not modify functional code during verification.
  - Flag any errors, but keep original files intact.
  - If issues are found, generate short fix suggestions per file.
Compare this snippet from backend/patches/core_service_render_patch.yaml:
summary: "Elevate core template to Render-ready FastAPI service with health endpoints, UTF-8 enforcement, and Supabase schema ping."
rationale: "This change is necessary to ensure the core service meets the requirements for deployment on Render, including compliance with UTF-8 standards and proper integration with Supabase."
implementation_plan:
  steps:
    - "Import logging, asyncio, and middleware helpers."
    - "Instantiate FastAPI with title/version metadata."
    - "Apply UTF-8 middleware via backend/utils/middleware/utf8_enforcer.py once implemented."
    - "Define /health (lightweight) and /status (detailed) routes."
    - "Add startup event that attempts Supabase schema touch via utils.supabase_client (if available) and writes to logs." 
    - "Ensure locale env vars default to mi_NZ.UTF-8."
proposed_diff: |
  @@
-# core/main.py: Orchestrator API for Tiwhanawhana